<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The Messaging Layer Security (MLS) Extensions</title>
<meta content="Raphael Robert" name="author">
<meta content="
       The Messaging Layer Security (MLS) protocol is an asynchronous group
authenticated key exchange protocol. MLS provides a number of capabilities to
applications, as well as several extension points internal to the protocol. This
document provides a consolidated application API, guidance for how the
protocol's extension points should be used, and a few concrete examples of both
core protocol extensions and uses of the application API. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="messaging layer security" name="keyword">
<meta content="end-to-end encryption" name="keyword">
<meta content="application api" name="keyword">
<meta content="extension" name="keyword">
<meta content="extensibility" name="keyword">
<meta content="draft-ietf-mls-extensions-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.5.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-ietf-mls-extensions.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">MLS</td>
<td class="right">December 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Robert</td>
<td class="center">Expires 20 June 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Messaging Layer Security</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-mls-extensions-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-12-17" class="published">17 December 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-06-20">20 June 2026</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Robert</div>
<div class="org">Phoenix R&amp;D</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The Messaging Layer Security (MLS) Extensions</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The Messaging Layer Security (MLS) protocol is an asynchronous group
authenticated key exchange protocol. MLS provides a number of capabilities to
applications, as well as several extension points internal to the protocol. This
document provides a consolidated application API, guidance for how the
protocol's extension points should be used, and a few concrete examples of both
core protocol extensions and uses of the application API.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://mlswg.github.io/mls-extensions/draft-ietf-mls-extensions.html">https://mlswg.github.io/mls-extensions/draft-ietf-mls-extensions.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-mls-extensions/">https://datatracker.ietf.org/doc/draft-ietf-mls-extensions/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Messaging Layer Security Working Group mailing list (<span><a href="mailto:mls@ietf.org">mailto:mls@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/mls/">https://mailarchive.ietf.org/arch/browse/mls/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/mls/">https://www.ietf.org/mailman/listinfo/mls/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/mlswg/mls-extensions">https://github.com/mlswg/mls-extensions</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 20 June 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-developing-extensions-for-t" class="internal xref">Developing Extensions for the MLS Protocol</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-the-safe-application-interf" class="internal xref">The Safe Application Interface</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-component-ids" class="internal xref">Component IDs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-hybrid-public-key-encryptio" class="internal xref">Hybrid Public Key Encryption (HPKE) Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-signature-keys" class="internal xref">Signature Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-exported-secrets" class="internal xref">Exported Secrets</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-pre-shared-keys-psks" class="internal xref">Pre-Shared Keys (PSKs)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-attaching-application-data-" class="internal xref">Attaching Application Data to MLS Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-updating-application-data-i" class="internal xref">Updating Application Data in the GroupContext</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="auto internal xref">4.8</a>.  <a href="#name-attaching-application-data-t" class="internal xref">Attaching Application Data to a Commit</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="auto internal xref">4.9</a>.  <a href="#name-safe-additional-authenticat" class="internal xref">Safe Additional Authenticated Data (AAD)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-negotiating-extensions-and-" class="internal xref">Negotiating Extensions and Components</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-grease" class="internal xref">GREASE</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-extensions" class="internal xref">Extensions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-appack" class="internal xref">AppAck</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-content-advertisement" class="internal xref">Content Advertisement</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-description" class="internal xref">Description</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="auto internal xref">6.2.2</a>.  <a href="#name-syntax" class="internal xref">Syntax</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="auto internal xref">6.2.3</a>.  <a href="#name-expected-behavior" class="internal xref">Expected Behavior</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.4">
                    <p id="section-toc.1-1.6.2.2.2.4.1"><a href="#section-6.2.4" class="auto internal xref">6.2.4</a>.  <a href="#name-framing-of-application_data" class="internal xref">Framing of application_data</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-selfremove-proposal" class="internal xref">SelfRemove Proposal</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="auto internal xref">6.3.1</a>.  <a href="#name-proposal-description" class="internal xref">Proposal Description</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-last-resort-keypackages" class="internal xref">Last resort KeyPackages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a href="#section-6.4.1" class="auto internal xref">6.4.1</a>.  <a href="#name-description-2" class="internal xref">Description</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.2">
                    <p id="section-toc.1-1.6.2.4.2.2.1"><a href="#section-6.4.2" class="auto internal xref">6.4.2</a>.  <a href="#name-format" class="internal xref">Format</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-multi-credentials" class="internal xref">Multi-Credentials</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.1">
                    <p id="section-toc.1-1.6.2.5.2.1.1"><a href="#section-6.5.1" class="auto internal xref">6.5.1</a>.  <a href="#name-credential-bindings" class="internal xref">Credential Bindings</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.2">
                    <p id="section-toc.1-1.6.2.5.2.2.1"><a href="#section-6.5.2" class="auto internal xref">6.5.2</a>.  <a href="#name-verifying-a-multi-credentia" class="internal xref">Verifying a Multi-Credential</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-mls-wire-formats" class="internal xref">MLS Wire Formats</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-mls-extension-types" class="internal xref">MLS Extension Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-app_data_dictionary-mls-ext" class="internal xref">app_data_dictionary MLS Extension</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="auto internal xref">7.2.2</a>.  <a href="#name-supported_wire_formats-mls-" class="internal xref">supported_wire_formats MLS Extension</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.3">
                    <p id="section-toc.1-1.7.2.2.2.3.1"><a href="#section-7.2.3" class="auto internal xref">7.2.3</a>.  <a href="#name-required_wire_formats-mls-e" class="internal xref">required_wire_formats MLS Extension</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-mls-proposal-types" class="internal xref">MLS Proposal Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="auto internal xref">7.3.1</a>.  <a href="#name-appdataupdate-proposal" class="internal xref">AppDataUpdate Proposal</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="auto internal xref">7.3.2</a>.  <a href="#name-appephemeral-proposal" class="internal xref">AppEphemeral Proposal</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.3">
                    <p id="section-toc.1-1.7.2.3.2.3.1"><a href="#section-7.3.3" class="auto internal xref">7.3.3</a>.  <a href="#name-selfremove-proposal-2" class="internal xref">SelfRemove Proposal</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.4">
                    <p id="section-toc.1-1.7.2.3.2.4.1"><a href="#section-7.3.4" class="auto internal xref">7.3.4</a>.  <a href="#name-appack-proposal" class="internal xref">AppAck Proposal</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-mls-credential-types" class="internal xref">MLS Credential Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.1">
                    <p id="section-toc.1-1.7.2.4.2.1.1"><a href="#section-7.4.1" class="auto internal xref">7.4.1</a>.  <a href="#name-multi-credential" class="internal xref">Multi Credential</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.2">
                    <p id="section-toc.1-1.7.2.4.2.2.1"><a href="#section-7.4.2" class="auto internal xref">7.4.2</a>.  <a href="#name-weak-multi-credential" class="internal xref">Weak Multi Credential</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.3">
                    <p id="section-toc.1-1.7.2.4.2.3.1"><a href="#section-7.4.3" class="auto internal xref">7.4.3</a>.  <a href="#name-credentialbindingtbs" class="internal xref">CredentialBindingTBS</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-mls-component-types" class="internal xref">MLS Component Types</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-safe-application-api" class="internal xref">Safe Application API</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-appack-2" class="internal xref">AppAck</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-content-advertisement-2" class="internal xref">Content Advertisement</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-selfremove" class="internal xref">SelfRemove</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-multi-credentials-2" class="internal xref">Multi Credentials</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-change-log" class="internal xref">Change Log</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document defines extensions to MLS <span>[<a href="#RFC9420" class="cite xref">RFC9420</a>]</span> that are not part of the
main protocol specification, and uses them to explain how to extend the core
operation of the MLS protocol. It also describes how applications can safely
interact with MLS to take advantage of security features of MLS.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The MLS protocol is designed to be integrated into applications in order to
provide security services that the application requires. There are two
questions to answer when designing such an integration:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-3">
<li id="section-1-3.1">
          <p id="section-1-3.1.1">How does the application provide the services that MLS requires?<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-1-3.2">
          <p id="section-1-3.2.1">How does the application use MLS to get security benefits?<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-1-4">The MLS Architecture <span>[<a href="#I-D.ietf-mls-architecture" class="cite xref">I-D.ietf-mls-architecture</a>]</span> describes the requirements
for the first of these questions, namely the structure of the Delivery Service
and Authentication Service that MLS requires. The next section of this document
focuses on the second question.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">MLS itself offers some basic functions that applications can use, such as the
secure message encapsulation (PrivateMessage), the MLS exporter, and the epoch
authenticator. Current MLS applications make use of these mechanisms to achieve
a variety of confidentiality and authentication properties.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">As application designers become familiar with MLS, there is interest in
leveraging other cryptographic tools that an MLS group provides:<a href="#section-1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-7.1">
          <p id="section-1-7.1.1">HPKE (Hybrid Public Key Encryption <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>) and signature key pairs for
each member, where the private key is known only to that member, and the
public key is authenticated to the other members.<a href="#section-1-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-7.2">
          <p id="section-1-7.2.1">A pre-shared key mechanism that can allow an application to inject data into
the MLS key schedule.<a href="#section-1-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-7.3">
          <p id="section-1-7.3.1">An exporter mechanism that allows applications to derive secrets from the MLS
key schedule.<a href="#section-1-7.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-7.4">
          <p id="section-1-7.4.1">Association of data with Commits as a synchronization mechanism.<a href="#section-1-7.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-7.5">
          <p id="section-1-7.5.1">Binding of information to the GroupContext to confirm group agreement.<a href="#section-1-7.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-8">There is also interest in exposing an MLS group to multiple loosely coordinated
components of an application. To accommodate such cases, the above mechanisms
need to be exposed in such a way that the usage of different components do not
conflict with each other, or with MLS itself.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">This document defines a set of mechanisms that application components can use to
ensure that their use of these facilities is properly domain-separated from MLS
itself, and from other application components that might be using the same MLS
group.<a href="#section-1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document makes heavy use of the terminology and the names of structs in the
MLS specification <span>[<a href="#RFC9420" class="cite xref">RFC9420</a>]</span>. In addition, we introduce the following new
terms:<a href="#section-2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-3">
        <dt id="section-2-3.1">Application:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.2">
          <p id="section-2-3.2.1">The system that instantiates, manages, and uses an MLS group. Each MLS group
is used by exactly one application, but an application may maintain multiple
groups.<a href="#section-2-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">Application component:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.4">
          <p id="section-2-3.4.1">A subsystem of an application that has access to an MLS group.<a href="#section-2-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">Component ID:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.6">
          <p id="section-2-3.6.1">An identifier for an application component. These identifiers are assigned by
the application.<a href="#section-2-3.6.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="developing-extensions-for-the-mls-protocol">
<section id="section-3">
      <h2 id="name-developing-extensions-for-t">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-developing-extensions-for-t" class="section-name selfRef">Developing Extensions for the MLS Protocol</a>
      </h2>
<p id="section-3-1">MLS is highly extensible and was designed to be used in a variety of different
applications. As such, it is important to separate extensions that change the
behavior of an MLS stack, and application usages of MLS that just take advantage
of features of MLS or specific extensions (hereafter referred to as
<em>components</em>). Furthermore, it is essential that application components do not
change the security properties of MLS or require new security analysis of the
MLS protocol itself.<a href="#section-3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-safe-application-interface">
<section id="section-4">
      <h2 id="name-the-safe-application-interf">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-the-safe-application-interf" class="section-name selfRef">The Safe Application Interface</a>
      </h2>
<p id="section-4-1">The mechanisms in this section take MLS mechanisms that are either not
inherently designed to be used by applications, or not inherently designed to be
used by multiple application components, and adds a domain separator that
separates application usage from MLS usage, and application components' usage
from each other:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">Public-key encryption operations are tagged so that encrypted data
will only decrypt in the context of a given component.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">Signing operations are similarly tagged so that signatures will only verify
in the context of a given component.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.3">
          <p id="section-4-2.3.1">Exported values include an identifier for the component to which they are
being exported, so that different components will get different exported
values.<a href="#section-4-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.4">
          <p id="section-4-2.4.1">Pre-shared keys are identified as originating from a specific component, so
that different components' contributions to the MLS key schedule will not
collide.<a href="#section-4-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.5">
          <p id="section-4-2.5.1">Additional Authenticated Data (AAD) can be domain separated by component.<a href="#section-4-2.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">Similarly, the content of application messages (<code>application_data</code>) can be
distinguished and routed to different parts of an application according to
the media type of that content using the content negotiation mechanism defined
in <a href="#content-advertisement" class="auto internal xref">Section 6.2</a>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">We also define new general mechanisms that allow applications to take advantage
of the extensibility mechanisms of MLS without having to define extensions
themselves:<a href="#section-4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-5.1">
          <p id="section-4-5.1.1">An <code>app_data_dictionary</code> extension type that associates application data with
MLS messages or with the state of the group.<a href="#section-4-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-5.2">
          <p id="section-4-5.2.1">An AppEphemeral proposal type that enables arbitrary application data to
be associated with a Commit.<a href="#section-4-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-5.3">
          <p id="section-4-5.3.1">An AppDataUpdate proposal type that enables efficient updates to
an <code>app_data_dictionary</code> GroupContext extension.<a href="#section-4-5.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-6">As with the above, information carried in these proposals and extensions is
marked as belonging to a specific application component, so that components can
manage their information independently.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">The separation between components is achieved by the application assigning each
component a unique component ID number. These numbers are then incorporated into
the appropriate calculations in the protocol to achieve the required separation.<a href="#section-4-7" class="pilcrow">¶</a></p>
<div id="component-ids">
<section id="section-4.1">
        <h3 id="name-component-ids">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-component-ids" class="section-name selfRef">Component IDs</a>
        </h3>
<p id="section-4.1-1">A component ID is a four-byte value that uniquely identifies a component within
the scope of an application.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
uint16 ComponentID;
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">When a label is required for an operation, the following data structure is used.
The <code>base_label</code> field is always the fixed string "Application".  The
<code>component_id</code> field identifies the component performing the operation. The
<code>label</code> field identifies the operation being performed.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<div class="lang-tls sourcecode" id="section-4.1-4">
<pre>
struct {
  opaque base_label&lt;V&gt;; /* = "Application" */
  ComponentID component_id;
  opaque label&lt;V&gt;;
} ComponentOperationLabel;
</pre><a href="#section-4.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="safe-hpke">
<section id="section-4.2">
        <h3 id="name-hybrid-public-key-encryptio">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-hybrid-public-key-encryptio" class="section-name selfRef">Hybrid Public Key Encryption (HPKE) Keys</a>
        </h3>
<p id="section-4.2-1">This component of the API allows components to make use of the HPKE key pairs
generated by MLS. A component identified by a ComponentID can use any HPKE key
pair for any operation defined in <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>, such as encryption, exporting
keys, and the PSK mode, as long as the <code>info</code> input to <code>Setup&lt;MODE&gt;S</code> and
<code>Setup&lt;MODE&gt;R</code> is set to ComponentOperationLabel with <code>component_id</code> set to the
appropriate ComponentID. The <code>context</code> can be set to an arbitrary Context
specified by the application designer and can be empty if not needed. For
example, a component can use a key pair PublicKey, PrivateKey to encrypt data as
follows:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div class="lang-tls sourcecode" id="section-4.2-2">
<pre>
SafeEncryptWithLabel(PublicKey, ComponentID, Label, Context, Plaintext) =
  EncryptWithLabel(PublicKey, ComponentOperationLabel, Context, Plaintext)

SafeDecryptWithLabel(PrivateKey, ComponentID, Label, Context, KEMOutput,
  Ciphertext) =
  DecryptWithLabel(PrivateKey, ComponentOperationLabel, Context,
    KEMOutput, Ciphertext)
</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2-3">Where the fields of ComponentOperationLabel are set to<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<div class="lang-tls sourcecode" id="section-4.2-4">
<pre>
component_id = ComponentID
label = Label
</pre><a href="#section-4.2-4" class="pilcrow">¶</a>
</div>
<p id="section-4.2-5">For operations involving the secret key, ComponentID <span class="bcp14">MUST</span> be set to the
ComponentID of the component performing the operation, and not to the ID of any
other component. In particular, this means that a component cannot decrypt data
meant for another component, while components can encrypt data that other
components can decrypt.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">In general, a ciphertext encrypted with a PublicKey can be decrypted by any
entity who has the corresponding PrivateKey at a given point in time according
to the MLS protocol (or application component). For convenience, the following
list summarizes lifetimes of MLS key pairs.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-7.1">
            <p id="section-4.2-7.1.1">The key pair of a non-blank ratchet tree node. The PrivateKey of such a key
pair is known to all members in the node’s subtree. In particular, a
PrivateKey of a leaf node is known only to the member in that leaf. A member
in the subtree stores the PrivateKey for a number of epochs, as long as the
PublicKey does not change. The key pair of the root node <span class="bcp14">SHOULD NOT</span> be used,
since the external key pair recalled below gives better security.<a href="#section-4.2-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-7.2">
            <p id="section-4.2-7.2.1">The external_priv, external_pub key pair used for external initialization. The
external_priv key is known to all group members in the current epoch. A member
stores external_priv only for the current epoch. Using this key pair gives
better security guarantees than using the key pair of the root of the ratchet
tree and should always be preferred.<a href="#section-4.2-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-7.3">
            <p id="section-4.2-7.3.1">The init_key in a KeyPackage and the corresponding secret key. The secret key
is known only to the owner of the KeyPackage and is deleted immediately after
it is used to join a group.<a href="#section-4.2-7.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="signature-keys">
<section id="section-4.3">
        <h3 id="name-signature-keys">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-signature-keys" class="section-name selfRef">Signature Keys</a>
        </h3>
<p id="section-4.3-1">MLS session states contain a number of signature keys including the ones in the
LeafNode structs. Application components can safely sign content and verify
signatures using these keys via the SafeSignWithLabel and SafeVerifyWithLabel
functions, respectively, much like how the basic MLS protocol uses SignWithLabel
and VerifyWithLabel.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">In more detail, a component identified by ComponentID should sign and verify
using:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<div class="lang-tls sourcecode" id="section-4.3-3">
<pre>
SafeSignWithLabel(SignatureKey, ComponentID, Label, Content) =
  SignWithLabel(SignatureKey, ComponentOperationLabel, Content)

SafeVerifyWithLabel(VerificationKey, ComponentID, Label, Content,
  SignatureValue) =
  VerifyWithLabel(VerificationKey, ComponentOperationLabel, Content,
  SignatureValue)
</pre><a href="#section-4.3-3" class="pilcrow">¶</a>
</div>
<p id="section-4.3-4">Where the fields of ComponentOperationLabel are set to<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<div class="lang-tls sourcecode" id="section-4.3-5">
<pre>
component_id = ComponentID
label = Label
</pre><a href="#section-4.3-5" class="pilcrow">¶</a>
</div>
<p id="section-4.3-6">For signing operations, the ComponentID <span class="bcp14">MUST</span> be set to the ComponentID of the
component performing the signature, and not to the ID of any other component.
This means that a component cannot produce signatures in place of other
component. However, components can verify signatures computed by other
components. Domain separation is ensured by explicitly including the ComponentID
with every operation.<a href="#section-4.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="exported-secrets">
<section id="section-4.4">
        <h3 id="name-exported-secrets">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-exported-secrets" class="section-name selfRef">Exported Secrets</a>
        </h3>
<p id="section-4.4-1">The MLS Exporter functionality described in <span><a href="https://rfc-editor.org/rfc/rfc9420#section-8.5" class="relref">Section 8.5</a> of [<a href="#RFC9420" class="cite xref">RFC9420</a>]</span> does not
provide forward security for exported secrets, because the <code>exporter_secret</code> is
not deleted after a secret has been derived.  In this section, we define a
forward-secure exporter for use by application components.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">The safe exporter is constructed from an Exporter Tree, tree of secrets with the
same structure as the Secret Tree defined in <span><a href="https://rfc-editor.org/rfc/rfc9420#section-9" class="relref">Section 9</a> of [<a href="#RFC9420" class="cite xref">RFC9420</a>]</span>, with two
differences: First, an Exporter Tree always has 2<sup>16</sup> leaves,
corresponding to the 16 bits of a ComponentID value. (As with the Secret Tree,
the nodes of the tree can be generated on-demand, for space-efficiency.) Second,
the root of the Exporter Tree is the <code>application_export_secret</code>, an additional
secret derived from the <code>epoch_secret</code> at the beginning of the epoch in the same
way as the other secrets listed in Table 4 of <span>[<a href="#RFC9420" class="cite xref">RFC9420</a>]</span> using the label
<code>"application_export"</code>.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">This tree defines one exported secret per ComponentID.  The secret for a
ComponentID is the <code>tree_node_secret</code> at the leaf node for that ComponentID:<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-4">
<pre>
SafeExportSecret(ComponentID) = tree_node_[LeafIndex(ComponentID)]_secret
</pre><a href="#section-4.4-4" class="pilcrow">¶</a>
</div>
<p id="section-4.4-5">Upon generating an exported secret for a component, the MLS implementation <span class="bcp14">MUST</span>
regard that component's exported secret as "consumed", and delete any source key
material according to the deletion schedule in <span><a href="https://rfc-editor.org/rfc/rfc9420#section-9.2" class="relref">Section 9.2</a> of [<a href="#RFC9420" class="cite xref">RFC9420</a>]</span>.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pre-shared-keys-psks">
<section id="section-4.5">
        <h3 id="name-pre-shared-keys-psks">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-pre-shared-keys-psks" class="section-name selfRef">Pre-Shared Keys (PSKs)</a>
        </h3>
<p id="section-4.5-1">PSKs represent key material that is injected into the MLS key schedule when
creating or processing a commit as defined in <span><a href="https://rfc-editor.org/rfc/rfc9420#section-8.4" class="relref">Section 8.4</a> of [<a href="#RFC9420" class="cite xref">RFC9420</a>]</span>. Its
injection into the key schedule means that all group members have to agree on
the value of the PSK.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">While PSKs are typically cryptographic keys which due to their properties add to
the overall security of the group, the PSK mechanism can also be used to ensure
that all members of a group agree on arbitrary pieces of data represented as
octet strings (without the necessity of sending the data itself over the wire).
For example, a component can use the PSK mechanism to enforce that all group
members have access to and agree on a password or a shared file.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">This is achieved by creating a new epoch via a PSK proposal. Transitioning to
the new epoch requires using the information agreed upon.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">To facilitate using PSKs safely, this document defines a new PSKType for
application components. This provides domain separation between pre-shared keys
used by the core MLS protocol and applications, and between those used by
different components.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<div class="lang-tls-presentation sourcecode" id="section-4.5-5">
<pre>
enum {
  // ...
  application(3),
  (255)
} PSKType;

struct {
  PSKType psktype;
  select (PreSharedKeyID.psktype) {
    // ...
    case application:
      ComponentID component_id;
      opaque psk_id&lt;V&gt;;
  };
  opaque psk_nonce&lt;V&gt;;
} PreSharedKeyID;
</pre><a href="#section-4.5-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="attaching-application-data-to-mls-messages">
<section id="section-4.6">
        <h3 id="name-attaching-application-data-">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-attaching-application-data-" class="section-name selfRef">Attaching Application Data to MLS Messages</a>
        </h3>
<p id="section-4.6-1">The MLS GroupContext, LeafNode, KeyPackage, and GroupInfo objects each have an
<code>extensions</code> field that can carry additional data not defined by the MLS
specification. The <code>app_data_dictionary</code> extension provides a generic container
that applications can use to attach application data to these messages. Each
usage of the extension serves a slightly different purpose:<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-2.1">
            <p id="section-4.6-2.1.1">GroupContext: Confirms that all members of the group agree on the application
data, and automatically distributes it to new joiners.<a href="#section-4.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-2.2">
            <p id="section-4.6-2.2.1">KeyPackage and LeafNode: Associates the application data to a particular
client, and advertises it to the other members of the group.<a href="#section-4.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.6-2.3">
            <p id="section-4.6-2.3.1">GroupInfo: Distributes the application data confidentially to the new joiners
for whom the GroupInfo is encrypted (as a Welcome message).<a href="#section-4.6-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.6-3">The content of the <code>app_data_dictionary</code> extension is a serialized
AppDataDictionary object:<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<div class="lang-tls-presentation sourcecode" id="section-4.6-4">
<pre>
struct {
    ComponentID component_id;
    opaque data&lt;V&gt;;
} ComponentData;

struct {
    ComponentData component_data&lt;V&gt;;
} AppDataDictionary;
</pre><a href="#section-4.6-4" class="pilcrow">¶</a>
</div>
<p id="section-4.6-5">The entries in the <code>component_data</code> <span class="bcp14">MUST</span> be sorted by <code>component_id</code>, and there
<span class="bcp14">MUST</span> be at most one entry for each <code>component_id</code>.<a href="#section-4.6-5" class="pilcrow">¶</a></p>
<p id="section-4.6-6">An <code>app_data_dictionary</code> extension in a LeafNode, KeyPackage, or GroupInfo can
be set when the object is created. An <code>app_data_dictionary</code> extension in the
GroupContext needs to be managed using the tools available to update
GroupContext extensions. The creator of the group can set extensions
unilaterally. Thereafter, the AppDataUpdate proposal described in the next
section is used to update the <code>app_data_dictionary</code> extension.<a href="#section-4.6-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="appdataupdate">
<section id="section-4.7">
        <h3 id="name-updating-application-data-i">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-updating-application-data-i" class="section-name selfRef">Updating Application Data in the GroupContext</a>
        </h3>
<p id="section-4.7-1">Updating the <code>app_data_dictionary</code> with a GroupContextExtensions proposal is
cumbersome. The application data needs to be transmitted in its entirety, along
with any other extensions, whether or not they are being changed. And a
GroupContextExtensions proposal always requires an UpdatePath, which updating
application state never should.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">The AppDataUpdate proposal allows the <code>app_data_dictionary</code> extension to be
updated without these costs. Instead of sending the whole value of the
extension, it sends only an update, which is interpreted by the application to
provide the new content for the <code>app_data_dictionary</code> extension. No other
extensions are sent or updated, and no UpdatePath is required.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.7-3">
<pre>
enum {
    invalid(0),
    update(1),
    remove(2),
    (255)
} AppDataUpdateOperation;

struct {
    ComponentID component_id;
    AppDataUpdateOperation op;

    select (AppDataUpdate.op) {
        case update: opaque update&lt;V&gt;;
        case remove: struct{};
    };
} AppDataUpdate;
</pre><a href="#section-4.7-3" class="pilcrow">¶</a>
</div>
<p id="section-4.7-4">An AppDataUpdate proposal is invalid if its <code>component_id</code> references a
component that is not known to the application, or if it specifies the removal
of state for a <code>component_id</code> that has no state present. A proposal list is
invalid if it includes multiple AppDataUpdate proposals that <code>remove</code> state for
the same <code>component_id</code>, or proposals that both <code>update</code> and <code>remove</code> state for
the same <code>component_id</code>. In other words, for a given <code>component_id</code>, a proposal
list is valid only if it contains (a) a single <code>remove</code> operation or (b) one or
more <code>update</code> operation.<a href="#section-4.7-4" class="pilcrow">¶</a></p>
<p id="section-4.7-5">AppDataUpdate proposals are processed after any default proposals (i.e., those
defined in <span>[<a href="#RFC9420" class="cite xref">RFC9420</a>]</span>), and any AppEphemeral proposals (defined in
<a href="#app-ephemeral" class="auto internal xref">Section 4.8</a>).<a href="#section-4.7-5" class="pilcrow">¶</a></p>
<p id="section-4.7-6">When an MLS group contains the AppDataUpdate proposal type in the
<code>proposal_types</code> list in the group's <code>required_capabilities</code> extension, a
GroupContextExtensions proposal <span class="bcp14">MUST NOT</span> add, remove, or modify the
<code>app_data_dictionary</code> GroupContext extension. In other words, when every member
of the group supports the AppDataUpdate proposal, a GroupContextExtensions
proposal could be sent to update some other extension(s), but the
<code>app_data_dictionary</code> GroupContext extension, if it exists, is left as it was.<a href="#section-4.7-6" class="pilcrow">¶</a></p>
<p id="section-4.7-7">A commit can contain a GroupContextExtensions proposal which modifies
GroupContext extensions other than <code>app_data_dictionary</code>, and can be followed by
zero or more AppDataUpdate proposals. This allows modifications to both the
<code>app_data_dictionary</code> extension (via AppDataUpdate) and other extensions (via
GroupContextExtensions) in the same Commit.<a href="#section-4.7-7" class="pilcrow">¶</a></p>
<p id="section-4.7-8">A client applies AppDataUpdate proposals by component ID. For each
<code>component_id</code> field that appears in an AppDataUpdate proposal in the Commit,
the client assembles a list of AppDataUpdate proposals with that <code>component_id</code>,
in the order in which they appear in the Commit, and processes them in the
following way:<a href="#section-4.7-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-9.1">
            <p id="section-4.7-9.1.1">If the list comprises a single proposal with the <code>op</code> field set to <code>remove</code>:<a href="#section-4.7-9.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-9.1.2.1">
                <p id="section-4.7-9.1.2.1.1">If there is an entry in the <code>component_states</code> vector in the
<code>application_state</code> extension with the specified <code>component_id</code>, remove
it.<a href="#section-4.7-9.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.7-9.1.2.2">
                <p id="section-4.7-9.1.2.2.1">Otherwise, the proposal is invalid.<a href="#section-4.7-9.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.7-9.2">
            <p id="section-4.7-9.2.1">If the list comprises one or more proposals, all with <code>op</code> field set to
<code>update</code>:<a href="#section-4.7-9.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.7-9.2.2.1">
                <p id="section-4.7-9.2.2.1.1">Provide the application logic registered to the <code>component_id</code> value with
the content of the <code>update</code> field from each proposal, in the order
specified.<a href="#section-4.7-9.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.7-9.2.2.2">
                <p id="section-4.7-9.2.2.2.1">The application logic returns either an opaque value <code>new_data</code> that will
be stored as the new application data for this component, or else an
indication that it considers this update invalid.<a href="#section-4.7-9.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.7-9.2.2.3">
                <p id="section-4.7-9.2.2.3.1">If the application logic considers the update invalid, the MLS client <span class="bcp14">MUST</span>
consider the proposal list invalid.<a href="#section-4.7-9.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.7-9.2.2.4">
                <p id="section-4.7-9.2.2.4.1">If no <code>app_data_dictionary</code> extension is present in the GroupContext, add
one to the end of the <code>extensions</code> list in the GroupContext.<a href="#section-4.7-9.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.7-9.2.2.5">
                <p id="section-4.7-9.2.2.5.1">If there is an entry in the <code>component_data</code> vector in the
<code>app_data_dictionary</code> extension with the specified <code>component_id</code>, then
set its <code>data</code> field to the specified <code>new_data</code>.<a href="#section-4.7-9.2.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.7-9.2.2.6">
                <p id="section-4.7-9.2.2.6.1">Otherwise, insert a new entry in the <code>component_states</code> vector with the
specified <code>component_id</code> and the <code>data</code> field set to the <code>new_data</code> value.
The new entry is inserted at the proper point to keep the
<code>component_states</code> vector sorted by <code>component_id</code>.<a href="#section-4.7-9.2.2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.7-9.3">
            <p id="section-4.7-9.3.1">Otherwise, the proposal list is invalid.<a href="#section-4.7-9.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.7-10.1">
            <p id="section-4.7-10.1.1">NOTE: An alternative design here would be to have the <code>update</code> operation
simply set the new value for the <code>app_data_dictionary</code> GCE, instead of sending a
diff. This would be simpler in that the MLS stack wouldn't have to ask the
application for the new state value, and would discourage applications from
storing large state in the GroupContext directly (which bloats Welcome
messages). It would effectively require the state in the GroupContext to be a
hash of the real state, to avoid large AppDataUpdate proposals. This
pushes some complexity onto the application, since the application has to
define a hashing algorithm, and define its own scheme for initializing new
joiners.<a href="#section-4.7-10.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.7-11">AppDataUpdate proposals do not require an UpdatePath. An AppDataUpdate proposal
can be sent by an external sender. Likewise, AppDataUpdate proposals can be
included in an external commit. Applications can make more restrictive validity
rules for the update of their components, such that some components would not be
valid at the application when sent in an external commit or via an external
proposer.<a href="#section-4.7-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="app-ephemeral">
<section id="section-4.8">
        <h3 id="name-attaching-application-data-t">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-attaching-application-data-t" class="section-name selfRef">Attaching Application Data to a Commit</a>
        </h3>
<p id="section-4.8-1">The AppEphemeral proposal type allows an application component to associate
application data to a Commit, so that the member processing the Commit knows
that all other group members will be processing the same data. AppEphemeral
proposals are ephemeral in the sense that they do not change any persistent
state related to MLS, aside from their appearance in the transcript hash.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<p id="section-4.8-2">The content of an AppEphemeral proposal is the same as an <code>app_data_dictionary</code>
extension. The proposal type is set in <a href="#iana-considerations" class="auto internal xref">Section 7</a>.<a href="#section-4.8-2" class="pilcrow">¶</a></p>
<div class="lang-tls-presentation sourcecode" id="section-4.8-3">
<pre>
struct {
    ComponentID component_id;
    opaque data&lt;V&gt;;
} AppEphemeral;
</pre><a href="#section-4.8-3" class="pilcrow">¶</a>
</div>
<p id="section-4.8-4">An AppEphemeral proposal is invalid if it contains a <code>component_id</code> that is
unknown to the application, or if the <code>app_data_dictionary</code> field contains any
<code>ComponentData</code> entry whose <code>data</code> field is considered invalid by the
application logic registered to the indicated <code>component_id</code>.<a href="#section-4.8-4" class="pilcrow">¶</a></p>
<p id="section-4.8-5">AppEphemeral proposals <span class="bcp14">MUST</span> be processed after any default proposals (i.e.,
those defined in <span>[<a href="#RFC9420" class="cite xref">RFC9420</a>]</span>), but before any AppDataUpdate proposals.<a href="#section-4.8-5" class="pilcrow">¶</a></p>
<p id="section-4.8-6">A client applies an AppEphemeral proposal by providing the contents of the
<code>app_data_dictionary</code> field to the component identified by the <code>component_id</code>.
If a Commit references more than one AppEphemeral proposal for the same
<code>component_id</code> value, then they <span class="bcp14">MUST</span> be processed in the order in which they are
specified in the Commit.<a href="#section-4.8-6" class="pilcrow">¶</a></p>
<p id="section-4.8-7">AppEphemeral proposals do not require an UpdatePath. An AppEphemeral proposal
can be sent by an external sender. Likewise, AppEphemeral proposals can be
included in an external commit. Applications can make more restrictive validity
rules for ephemeral updates of their components, such that some components would
not be valid at the application when sent in an external commit or via an
external proposer.<a href="#section-4.8-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="safe-aad">
<section id="section-4.9">
        <h3 id="name-safe-additional-authenticat">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-safe-additional-authenticat" class="section-name selfRef">Safe Additional Authenticated Data (AAD)</a>
        </h3>
<p id="section-4.9-1">Both MLS <code>PublicMessage</code> and <code>PrivateMessage</code> messages can contain arbitrary
additional application-specific data. The corresponding <code>authenticated_data</code>
field that conveys this application-specific data appears in the
<code>FramedContent</code> struct for <code>PublicMessage</code> and directly in the <code>PrivateMessage</code>
struct.<a href="#section-4.9-1" class="pilcrow">¶</a></p>
<p id="section-4.9-2">In an MLS <code>PrivateMessage</code>, the <code>application_data</code> is also present in
intermediary structs: in the <code>FramedContent</code>, which is used to generate the
message signature and tags, and in the <code>PrivateContentAAD</code>, which is used as
the AAD input to the <code>PrivateMessage.ciphertext</code>.<a href="#section-4.9-2" class="pilcrow">¶</a></p>
<p id="section-4.9-3">The Safe AAD API defines a framing used to allow multiple application components
to add AAD safely to the <code>authenticated_data</code> without conflicts or ambiguity.<a href="#section-4.9-3" class="pilcrow">¶</a></p>
<p id="section-4.9-4">When any AAD safe extension is included in the <code>authenticated_data</code> field, the
"safe" AAD items <span class="bcp14">MUST</span> come before any non-safe data in the <code>authenticated_data</code>
field. Safe AAD items are framed using the <code>SafeAAD</code> struct and are sorted in
increasing numerical order of the <code>component_id</code>. The struct is described below:<a href="#section-4.9-4" class="pilcrow">¶</a></p>
<div class="lang-tls-presentation sourcecode" id="section-4.9-5">
<pre>
struct {
  ComponentID component_id;
  opaque aad_item_data&lt;V&gt;;
} SafeAADItem;

struct {
  SafeAADItem aad_items&lt;V&gt;;
} SafeAAD;
</pre><a href="#section-4.9-5" class="pilcrow">¶</a>
</div>
<p id="section-4.9-6">If the <code>SafeAAD</code> is present or not in the <code>authenticated_data</code> is determined by
the presence of the <code>safe_aad</code> component in the <code>app_data_dictionary</code> extension
in the GroupContext (see <a href="#negotiation" class="auto internal xref">Section 5</a>). If <code>safe_aad</code> is present, but none of
the "safe" AAD components have data to send in a particular message, the
<code>aad_items</code> is a zero-length vector.<a href="#section-4.9-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="negotiation">
<section id="section-5">
      <h2 id="name-negotiating-extensions-and-">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-negotiating-extensions-and-" class="section-name selfRef">Negotiating Extensions and Components</a>
      </h2>
<p id="section-5-1">MLS defines a <code>Capabilities</code> struct for LeafNodes (in turn used in
KeyPackages), which describes which extensions are supported by the
associated node.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">However, that struct (defined in <span><a href="https://rfc-editor.org/rfc/rfc9420#section-7.2" class="relref">Section 7.2</a> of [<a href="#RFC9420" class="cite xref">RFC9420</a>]</span>) only has
fields for a subset of the extensions possible in MLS, as reproduced below.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div class="lang-tls-presentation sourcecode" id="section-5-3">
<pre>
struct {
    ProtocolVersion versions&lt;V&gt;;
    CipherSuite cipher_suites&lt;V&gt;;
    ExtensionType extensions&lt;V&gt;;
    ProposalType proposals&lt;V&gt;;
    CredentialType credentials&lt;V&gt;;
} Capabilities;
</pre><a href="#section-5-3" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5-4.1">
          <p id="section-5-4.1.1">The "MLS Extensions Types" registry represents extensibility of four
  core structs (<code>GroupContext</code>, <code>GroupInfo</code>, <code>KeyPackage</code>, and <code>LeafNode</code>)
  that have far reaching effects on the use of the protocol. The majority of
  MLS extensions in <span>[<a href="#RFC9420" class="cite xref">RFC9420</a>]</span> extend one or more of these core structs.<a href="#section-5-4.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-5">Likewise, the <code>required_capabilities</code> GroupContext extension (defined in
<span><a href="https://rfc-editor.org/rfc/rfc9420#section-11.1" class="relref">Section 11.1</a> of [<a href="#RFC9420" class="cite xref">RFC9420</a>]</span> and reproduced below) contains all mandatory to
support non-default extensions in its <code>extension_types</code> vector. Its
<code>proposal_types</code> vector contains any mandatory to support Proposals. Its
<code>credential_types</code> vector contains any mandatory credential types.<a href="#section-5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-6">
<pre>
struct {
   ExtensionType extension_types&lt;V&gt;;
   ProposalType proposal_types&lt;V&gt;;
   CredentialType credential_types&lt;V&gt;;
} RequiredCapabilities;
</pre><a href="#section-5-6" class="pilcrow">¶</a>
</div>
<p id="section-5-7">Due to an oversight in <span>[<a href="#RFC9420" class="cite xref">RFC9420</a>]</span>, the Capabilities struct does not include
MLS Wire Formats. Instead, this document defines two extensions:
<code>supported_wire_formats</code> (which can appear in LeafNodes), and
<code>required_wire_formats</code> (which can appear in the GroupContext).<a href="#section-5-7" class="pilcrow">¶</a></p>
<div class="lang-tls-presentation sourcecode" id="section-5-8">
<pre>
struct {
   WireFormat wire_formats&lt;V&gt;;
} WireFormats

WireFormats supported_wire_formats;
WireFormats requires_wire_formats;
</pre><a href="#section-5-8" class="pilcrow">¶</a>
</div>
<p id="section-5-9">This document also defines new components of the <code>app_data_dictionary</code> extension
for supported and required Safe AAD, media types, and components.<a href="#section-5-9" class="pilcrow">¶</a></p>
<p id="section-5-10">The <code>safe_aad</code> component contains a list of components IDs. When present (in an
<code>app_data_dictionary</code> extension) in a LeafNode, the semantic is the list of
supported components that use Safe AAD. When present (in an
<code>app_data_dictionary</code> extension) in the GroupContext, the semantic is the list
of required Safe AAD components (those that must be understood by the entire
group). If the <code>safe_aad</code> component is present, even with an empty list, (in the
<code>app_data_dictionary</code> extension) in the GroupContext, then the
<code>authenticated_data</code> field always starts with the SafeAAD struct defined in
<a href="#safe-aad" class="auto internal xref">Section 4.9</a>.<a href="#section-5-10" class="pilcrow">¶</a></p>
<div class="lang-tls-presentation sourcecode" id="section-5-11">
<pre>
struct {
    ComponentID component_ids&lt;V&gt;;
} ComponentsList;

ComponentsList safe_aad;
</pre><a href="#section-5-11" class="pilcrow">¶</a>
</div>
<p id="section-5-12">The list of required and supported components follows the same model with the
new component <code>app_components</code>. When present in a LeafNode, the semantic is the
list of supported components. When present in the GroupContext, the semantic is
the list of required components.<a href="#section-5-12" class="pilcrow">¶</a></p>
<div class="lang-tls-presentation sourcecode" id="section-5-13">
<pre>
ComponentsList app_components;
</pre><a href="#section-5-13" class="pilcrow">¶</a>
</div>
<p id="section-5-14">Finally, the supported and required media types (formerly called MIME types) are
communicated in the <code>content_media_types</code> component (see
<a href="#content-advertisement" class="auto internal xref">Section 6.2</a>).<a href="#section-5-14" class="pilcrow">¶</a></p>
<div id="grease">
<section id="section-5.1">
        <h3 id="name-grease">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-grease" class="section-name selfRef">GREASE</a>
        </h3>
<p id="section-5.1-1">The "Generate Random Extensions And Sustain Extensibility" (GREASE) approach is
described in <span><a href="https://rfc-editor.org/rfc/rfc9420#section-13.5" class="relref">Section 13.5</a> of [<a href="#RFC9420" class="cite xref">RFC9420</a>]</span>. Further, <span><a href="https://rfc-editor.org/rfc/rfc9420#section-7.2" class="relref">Section 7.2</a> of [<a href="#RFC9420" class="cite xref">RFC9420</a>]</span>
says that:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.1-2.1">
            <p id="section-5.1-2.1.1">"As discussed in Section 13, unknown values in <code>capabilities</code> <span class="bcp14">MUST</span> be ignored,
and the creator of a <code>capabilities</code> field <span class="bcp14">SHOULD</span> include some random GREASE
values to help ensure that other clients correctly ignore unknown values."<a href="#section-5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.1-3">This specification adds the following locations where GREASE values for
components can be included:<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-4.1">
            <p id="section-5.1-4.1.1">LeafNode.capabilities.app_data_dictionary.safe_aad<a href="#section-5.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-4.2">
            <p id="section-5.1-4.2.1">LeafNode.capabilities.app_data_dictionary.app_components<a href="#section-5.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-4.3">
            <p id="section-5.1-4.3.1">LeafNode.extensions.app_data_dictionary<a href="#section-5.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-4.4">
            <p id="section-5.1-4.4.1">KeyPackage.extensions.app_data_dictionary<a href="#section-5.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-4.5">
            <p id="section-5.1-4.5.1">GroupInfo.extensions.app_data_dictionary<a href="#section-5.1-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-4.6">
            <p id="section-5.1-4.6.1">app_ephemeral.app_data_dictionary<a href="#section-5.1-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-4.7">
            <p id="section-5.1-4.7.1">authenticated_data.aad_items<a href="#section-5.1-4.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.1-5">Unknown values (including GREASE values) in any of these fields <span class="bcp14">MUST</span> be ignored
by receivers. A random selection of GREASE values <span class="bcp14">SHOULD</span> be included in any of
these fields that would otherwise be present.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="extensions">
<section id="section-6">
      <h2 id="name-extensions">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-extensions" class="section-name selfRef">Extensions</a>
      </h2>
<div id="appack">
<section id="section-6.1">
        <h3 id="name-appack">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-appack" class="section-name selfRef">AppAck</a>
        </h3>
<p id="section-6.1-1">An AppAck object is used to acknowledge receipt of application messages. Though
this information implies no change to the group, it is conveyed inside an
AppEphermeral Proposal with a component ID <code>app_ack</code>, so that it is included in
the group's transcript by being included in Commit messages.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div class="lang-tls sourcecode" id="section-6.1-2">
<pre>
struct {
    uint32 sender;
    uint32 first_generation;
    uint32 last_generation;
} MessageRange;

struct {
    MessageRange received_ranges&lt;V&gt;;
} AppAck;
</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1-3">An AppAck represents a set of messages received by the sender in the current
epoch. Messages are represented by the <code>sender</code> and <code>generation</code> values in the
MLSCiphertext for the message. Each MessageRange represents receipt of a span of
messages whose <code>generation</code> values form a continuous range from
<code>first_generation</code> to <code>last_generation</code>, inclusive.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">AppAck objects are sent as a guard against the Delivery Service dropping
application messages. The sequential nature of the <code>generation</code> field provides a
degree of loss detection, since gaps in the <code>generation</code> sequence indicate
dropped messages. AppAck completes this story by addressing the scenario where
the Delivery Service drops all messages after a certain point, so that a later
generation is never observed. Obviously, there is a risk that AppAck messages
could be suppressed as well, but their inclusion in the transcript means that if
they are suppressed then the group cannot advance at all.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="content-advertisement">
<section id="section-6.2">
        <h3 id="name-content-advertisement">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-content-advertisement" class="section-name selfRef">Content Advertisement</a>
        </h3>
<div id="description">
<section id="section-6.2.1">
          <h4 id="name-description">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-description" class="section-name selfRef">Description</a>
          </h4>
<p id="section-6.2.1-1">This section defines a minimal framing format so MLS clients can signal which
media type is being sent inside the MLS <code>application_data</code> object when multiple
formats are permitted in the same group.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">It also defines a new <code>content_media_types</code> application component which is used
to indicate support for specific formats, using the extensive IANA Media Types
registry (formerly called MIME Types). When the <code>content_media_types</code> component
is present (in the <code>app_data_dictionary</code> extension) in a LeafNode, it indicates
that node's support for a particular (non-empty) list of media types. When the
<code>content_media_types</code> component is present (in the <code>app_data_dictionary</code>
extension) in the GroupContext, it indicates a (non-empty) list of media types
that need to be supported by all members of that MLS group, <em>and</em> that the
<code>application_data</code> will be framed using the application framing format described
later in <a href="#app-framing" class="auto internal xref">Section 6.2.4</a>. This allows clients to confirm that all members of a
group can communicate.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2.1-3.1">
              <p id="section-6.2.1-3.1.1">Note that when the membership of a group changes, or when the policy of the
 group changes, it is responsibility of the committer to ensure that the
 membership and policies are compatible.<a href="#section-6.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.2.1-4">As clients are upgraded to support new formats they can use these extensions to
detect when all members support a new or more efficient encoding, or select the
relevant format or formats to send.<a href="#section-6.2.1-4" class="pilcrow">¶</a></p>
<p id="section-6.2.1-5">Vendor-specific media subtypes starting with <code>vnd.</code> can be registered with IANA
without standards action as described in <span>[<a href="#RFC6838" class="cite xref">RFC6838</a>]</span>. Implementations which
wish to send multiple formats in a single application message, may be interested
in the <code>multipart/alternative</code> media type defined in <span>[<a href="#RFC2046" class="cite xref">RFC2046</a>]</span> or may use or
define another type with similar semantics (for example using TLS Presentation
Language syntax <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>).<a href="#section-6.2.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2.1-6.1">
              <p id="section-6.2.1-6.1.1">Note that the usage of IANA media types in general does not imply the usage of
 MIME Headers <span>[<a href="#RFC2045" class="cite xref">RFC2045</a>]</span> for framing.<a href="#section-6.2.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="syntax">
<section id="section-6.2.2">
          <h4 id="name-syntax">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-syntax" class="section-name selfRef">Syntax</a>
          </h4>
<p id="section-6.2.2-1">MediaType is a TLS encoding of a single IANA media type (including top-level
type and subtype) and any of its parameters. Even if the <code>parameter_value</code> would
have required formatting as a <code>quoted-string</code> in a text encoding, only the
contents inside the <code>quoted-string</code> are included in <code>parameter_value</code>. Likewise,
only the second character of a <code>quoted-pair</code> is included in <code>parameter_value</code>;
the first escaping backslash ("") is omitted. MediaTypeList is an ordered list
of MediaType objects.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<div class="lang-tls sourcecode" id="section-6.2.2-2">
<pre>
struct {
    opaque parameter_name&lt;V&gt;;
    /* Note: parameter_value never includes the quotation marks of */
    /* an RFC 2045 quoted-string or the first "\" of a quoted-pair */
    opaque parameter_value&lt;V&gt;;
} Parameter;

struct {
    /* media_type is an IANA top-level media type, a "/" character,
     * and the IANA media subtype */
    opaque media_type&lt;V&gt;;

    /* a list of zero or more parameters defined for the subtype */
    Parameter parameters&lt;V&gt;;
} MediaType;

struct {
    /* must contain at least one item */
    MediaType media_types&lt;V&gt;;
} MediaTypeList;

MediaTypeList content_media_types;
</pre><a href="#section-6.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.2-3">Example IANA media types with optional parameters:<a href="#section-6.2.2-3" class="pilcrow">¶</a></p>
<div class="lang-artwork sourcecode" id="section-6.2.2-4">
<pre>
  image/png
  text/plain ;charset="UTF-8"
  application/json
  application/vnd.example.msgbus+cbor
</pre><a href="#section-6.2.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2.2-5">For the example media type for <code>text/plain</code>, the <code>media_type</code> field would be
<code>text/plain</code>, <code>parameters</code> would contain a single Parameter with a
<code>parameter_name</code> of <code>charset</code> and a <code>parameter_value</code> of <code>UTF-8</code>.<a href="#section-6.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="expected-behavior">
<section id="section-6.2.3">
          <h4 id="name-expected-behavior">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-expected-behavior" class="section-name selfRef">Expected Behavior</a>
          </h4>
<p id="section-6.2.3-1">An MLS client which implements this section <span class="bcp14">SHOULD</span> include the
<code>content_media_types</code> component (in the <code>app_data_dictionary</code> extension) in its
LeafNodes, listing all the media types it can receive. As usual, the client also
includes <code>content_media_types</code> in the <code>app_components</code> list (in the
<code>app_data_dictionary</code> extension) and support for the <code>app_data_dictionary</code>
extension in its <code>capabilities.extensions</code> field in its LeafNodes (including in
LeafNodes inside its KeyPackages).<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
<p id="section-6.2.3-2">When creating a new MLS group for an application using this specification, the
group <span class="bcp14">MAY</span> include a <code>content_media_types</code> component (in the
<code>app_data_dictionary</code> extension) in the GroupContext. (The creating client also
includes its <code>content_media_types</code> component in its own LeafNode as described in
the previous paragraph.)<a href="#section-6.2.3-2" class="pilcrow">¶</a></p>
<p id="section-6.2.3-3">MLS clients <span class="bcp14">SHOULD NOT</span> add an MLS client to an MLS group with
<code>content_media_types</code> in its GroupContext unless the MLS client advertises it
can support all the required MediaTypes. As an exception, a client could be
preconfigured to know that certain clients support the required types. Likewise,
an MLS client is already forbidden from issuing or committing a
GroupContextExtensions Proposal which introduces required extensions which are
not supported by all members in the resulting epoch.<a href="#section-6.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="app-framing">
<section id="section-6.2.4">
          <h4 id="name-framing-of-application_data">
<a href="#section-6.2.4" class="section-number selfRef">6.2.4. </a><a href="#name-framing-of-application_data" class="section-name selfRef">Framing of application_data</a>
          </h4>
<p id="section-6.2.4-1">When an MLS group contains the <code>content_media_types</code> component (in the
<code>app_data_dictionary</code> extension) in its GroupContext, the <code>application_data</code>
sent in that group is interpreted as <code>ApplicationFraming</code> as defined below:<a href="#section-6.2.4-1" class="pilcrow">¶</a></p>
<div class="lang-tls sourcecode" id="section-6.2.4-2">
<pre>
  struct {
      MediaType media_type;
      opaque&lt;V&gt; inner_application_content;
  } ApplicationFraming;
</pre><a href="#section-6.2.4-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.4-3">The <code>media_type</code> <span class="bcp14">MAY</span> be zero length, in which case, the media type of the
<code>inner_application_content</code> is interpreted as the first MediaType specified in
the <code>content_media_types</code> component in the GroupContext.<a href="#section-6.2.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="selfremove-proposal">
<section id="section-6.3">
        <h3 id="name-selfremove-proposal">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-selfremove-proposal" class="section-name selfRef">SelfRemove Proposal</a>
        </h3>
<p id="section-6.3-1">The design of the MLS protocol prevents a member of an MLS group from removing
itself immediately from the group. (To cause an immediate change in the group, a
member must send a Commit message. However, the sender of a Commit message knows
the keying material of the new epoch and therefore needs to be part of the
group.) Instead, a member wishing to remove itself can send a Remove Proposal
and wait for another member to Commit its Proposal.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">Unfortunately, MLS clients that join via an External Commit ignore pending, but
otherwise valid, Remove Proposals. The member trying to remove itself has to
monitor the group and send a new Remove Proposal in every new epoch until the
member is removed. In a group with a burst of external joiners, a member
connected over a high-latency link (or one that is merely unlucky) might have to
wait several epochs to remove itself. A real-world situation in which this
happens is a member trying to remove itself from a conference call as several
dozen new participants are trying to join (often on the hour).<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">This section describes a new <code>SelfRemove</code> proposal type. It is designed to be
included in External Commits.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<div id="proposal-description">
<section id="section-6.3.1">
          <h4 id="name-proposal-description">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-proposal-description" class="section-name selfRef">Proposal Description</a>
          </h4>
<p id="section-6.3.1-1">This document specifies a new MLS Proposal type called <code>SelfRemove</code>. Its syntax
is described using the TLS Presentation Language <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> below (its content
is an empty struct). It is allowed in External Commits and requires an
UpdatePath. SelfRemove proposals are only allowed in a Commit by reference.
SelfRemove cannot be sent as an external proposal.<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
<div class="lang-tls-presentation sourcecode" id="section-6.3.1-2">
<pre>
struct {} SelfRemove;

struct {
    ProposalType msg_type;
    select (Proposal.msg_type) {
        case add:                      Add;
        case update:                   Update;
        case remove:                   Remove;
        case psk:                      PreSharedKey;
        case reinit:                   ReInit;
        case external_init:            ExternalInit;
        case group_context_extensions: GroupContextExtensions;
        case self_remove:              SelfRemove;
    };
} Proposal;
</pre><a href="#section-6.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.3.1-3">The description of behavior below only applies if all the members of a group
support this proposal in their capabilities; such a group is a
"self-remove-capable group".<a href="#section-6.3.1-3" class="pilcrow">¶</a></p>
<p id="section-6.3.1-4">An MLS client which supports this proposal can send a SelfRemove Proposal
whenever it would like to remove itself from a self-remove-capable group.
Because the point of a SelfRemove Proposal is to be available to external
joiners (which are not yet members), these proposals <span class="bcp14">MUST</span> be sent in an MLS
PublicMessage.<a href="#section-6.3.1-4" class="pilcrow">¶</a></p>
<p id="section-6.3.1-5">Whenever a member receives a SelfRemove Proposal, it includes it along with any
other pending Propsals when sending a Commit. It already <span class="bcp14">MUST</span> send a Commit of
pending Proposals before sending new application messages.<a href="#section-6.3.1-5" class="pilcrow">¶</a></p>
<p id="section-6.3.1-6">When a member receives a Commit referencing one or more SelfRemove Proposals, it
treats the proposal like a Remove Proposal, except the leaf node to remove is
determined by looking in the Sender <code>leaf_index</code> of the original Proposal. The
member is able to verify that the Sender was a member.<a href="#section-6.3.1-6" class="pilcrow">¶</a></p>
<p id="section-6.3.1-7">Whenever a new joiner is about to join a self-remove-capable group with an
External Commit, the new joiner <span class="bcp14">MUST</span> fetch any pending SelfRemove Proposals
along with the GroupInfo object, and include the SelfRemove Proposals in its
External Commit by reference. (An ExternalCommit can contain zero or more
SelfRemove proposals). The new joiner <span class="bcp14">MUST</span> validate the SelfRemove Proposal
before including it by reference, except that it skips the validation of the
<code>membership_tag</code> because a non-member cannot verify membership.<a href="#section-6.3.1-7" class="pilcrow">¶</a></p>
<p id="section-6.3.1-8">During validation, SelfRemove proposals are processed after Update proposals and
before Remove proposals. If there is a pending SelfRemove proposal for a
specific leaf node and a pending Remove proposal for the same leaf node, the
Remove proposal is invalid. A client <span class="bcp14">MUST NOT</span> issue more than one SelfRemove
proposal per epoch.<a href="#section-6.3.1-8" class="pilcrow">¶</a></p>
<p id="section-6.3.1-9">The MLS Delivery Service (DS) needs to validate SelfRemove Proposals it receives
(except that it cannot validate the <code>membership_tag</code>). If the DS provides a
GroupInfo object to an external joiner, the DS <span class="bcp14">SHOULD</span> attach any SelfRemove
proposals known to the DS to the GroupInfo object.<a href="#section-6.3.1-9" class="pilcrow">¶</a></p>
<p id="section-6.3.1-10">As with Remove proposals, clients need to be able to receive a Commit message
which removes them from the group via a SelfRemove. If the DS does not forward a
Commit to a removed client, it needs to inform the removed client out-of-band.<a href="#section-6.3.1-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="last-resort-keypackages">
<section id="section-6.4">
        <h3 id="name-last-resort-keypackages">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-last-resort-keypackages" class="section-name selfRef">Last resort KeyPackages</a>
        </h3>
<p id="section-6.4-1">Type: KeyPackage extension<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<div id="description-1">
<section id="section-6.4.1">
          <h4 id="name-description-2">
<a href="#section-6.4.1" class="section-number selfRef">6.4.1. </a><a href="#name-description-2" class="section-name selfRef">Description</a>
          </h4>
<p id="section-6.4.1-1"><span><a href="https://rfc-editor.org/rfc/rfc9420#section-10" class="relref">Section 10</a> of [<a href="#RFC9420" class="cite xref">RFC9420</a>]</span> details that clients are required to pre-publish
KeyPackages so that other clients can add them to groups asynchronously. It also
states that they should not be re-used:<a href="#section-6.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.1-2.1">
              <p id="section-6.4.1-2.1.1">KeyPackages are intended to be used only once and <span class="bcp14">SHOULD NOT</span> be reused except
in the case of a "last resort" KeyPackage (see Section 16.8). Clients <span class="bcp14">MAY</span>
generate and publish multiple KeyPackages to support multiple cipher suites.<a href="#section-6.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.4.1-3"><span><a href="https://rfc-editor.org/rfc/rfc9420#section-16.8" class="relref">Section 16.8</a> of [<a href="#RFC9420" class="cite xref">RFC9420</a>]</span> then introduces the notion of last-resort
KeyPackages as follows:<a href="#section-6.4.1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.1-4.1">
              <p id="section-6.4.1-4.1.1">An application <span class="bcp14">MAY</span> allow for reuse of a "last resort" KeyPackage in order to
prevent denial-of-service attacks.<a href="#section-6.4.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.4.1-5">However, <span>[<a href="#RFC9420" class="cite xref">RFC9420</a>]</span> does not specify how to distinguish regular KeyPackages
from last-resort ones. The last_resort_key_package KeyPackage application
component defined in this section fills this gap and allows clients to
specifically mark KeyPackages as KeyPackages of last resort that <span class="bcp14">MAY</span> be used
more than once in scenarios where all other KeyPackages have already been used.<a href="#section-6.4.1-5" class="pilcrow">¶</a></p>
<p id="section-6.4.1-6">The component allows clients that pre-publish KeyPackages to signal to the
Delivery Service which KeyPackage(s) are meant to be used as last resort
KeyPackages.<a href="#section-6.4.1-6" class="pilcrow">¶</a></p>
<p id="section-6.4.1-7">An additional benefit of using a component rather than communicating the
information out-of-band is that the component is still present in Add proposals.
Clients processing such Add proposals can authenticate that a KeyPackage is a
last-resort KeyPackage and <span class="bcp14">MAY</span> make policy decisions based on that information.<a href="#section-6.4.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="format">
<section id="section-6.4.2">
          <h4 id="name-format">
<a href="#section-6.4.2" class="section-number selfRef">6.4.2. </a><a href="#name-format" class="section-name selfRef">Format</a>
          </h4>
<p id="section-6.4.2-1">The purpose of the application component is simply to mark a given KeyPackage,
which means it carries no additional data.<a href="#section-6.4.2-1" class="pilcrow">¶</a></p>
<p id="section-6.4.2-2">As a result, a LastResort Extension contains the <code>component_id</code> with an empty
<code>data</code> field.<a href="#section-6.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="multi-credentials">
<section id="section-6.5">
        <h3 id="name-multi-credentials">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-multi-credentials" class="section-name selfRef">Multi-Credentials</a>
        </h3>
<p id="section-6.5-1">Multi-credentials address use cases where there might not be a single credential
that captures all of a client's authenticated attributes. For example, an
enterprise messaging client may wish to provide attributes both from its
messaging service, to prove that its user has a given handle in that service,
and from its corporate owner, to prove that its user is an employee of the
corporation. Multi-credentials can also be used in migration scenarios, where
some clients in a group might wish to rely on a newer type of credential, but
other clients haven't yet been upgraded.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">New credential types <code>MultiCredential</code> and <code>WeakMultiCredential</code> are defined as
shown below. These credential types are indicated with the values <code>multi</code> and
<code>weak-multi</code> (see <a href="#iana-creds" class="auto internal xref">Section 7.4</a>).<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<div class="lang-tls-presentation sourcecode" id="section-6.5-3">
<pre>
struct {
  CipherSuite cipher_suite;
  Credential credential;
  SignaturePublicKey credential_key;

  /* SignWithLabel(., "CredentialBindingTBS", CredentialBindingTBS) */
  opaque signature&lt;V&gt;;
} CredentialBinding

struct {
  CredentialBinding bindings&lt;V&gt;;
} MultiCredential;

struct {
  CredentialBinding bindings&lt;V&gt;;
} WeakMultiCredential;
</pre><a href="#section-6.5-3" class="pilcrow">¶</a>
</div>
<p id="section-6.5-4">The two types of credentials are processed in exactly the same way. The only
difference is in how they are treated when evaluating support by other clients,
as discussed below.<a href="#section-6.5-4" class="pilcrow">¶</a></p>
<div id="credential-bindings">
<section id="section-6.5.1">
          <h4 id="name-credential-bindings">
<a href="#section-6.5.1" class="section-number selfRef">6.5.1. </a><a href="#name-credential-bindings" class="section-name selfRef">Credential Bindings</a>
          </h4>
<p id="section-6.5.1-1">A multi-credential consists of a collection of "credential bindings". Each
credential binding is a signed statement by the holder of the credential that
the signature key in the LeafNode belongs to the holder of that credential.
Specifically, the signature is computed using the MLS <code>SignWithLabel</code> function,
with label <code>"CredentialBindingTBS"</code> and with a content that covers the contents
of the CredentialBinding, plus the <code>signature_key</code> field from the LeafNode in
which this credential will be embedded.<a href="#section-6.5.1-1" class="pilcrow">¶</a></p>
<div class="lang-tls-presentation sourcecode" id="section-6.5.1-2">
<pre>
struct {
  CipherSuite cipher_suite;
  Credential credential;
  SignaturePublicKey credential_key;
  SignaturePublicKey signature_key;
} CredentialBindingTBS;
</pre><a href="#section-6.5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.5.1-3">The <code>cipher_suite</code> for a credential is NOT <span class="bcp14">REQUIRED</span> to match the cipher suite
for the MLS group in which it is used, but <span class="bcp14">MUST</span> meet the support requirements
with regard to support by group members discussed below.<a href="#section-6.5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verifying-a-multi-credential">
<section id="section-6.5.2">
          <h4 id="name-verifying-a-multi-credentia">
<a href="#section-6.5.2" class="section-number selfRef">6.5.2. </a><a href="#name-verifying-a-multi-credentia" class="section-name selfRef">Verifying a Multi-Credential</a>
          </h4>
<p id="section-6.5.2-1">A credential binding is supported by a client if the client supports the
credential type and cipher suite of the binding. A credential binding is valid
in the context of a given LeafNode if both of the following are true:<a href="#section-6.5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5.2-2.1">
              <p id="section-6.5.2-2.1.1">The <code>credential</code> is valid according to the MLS Authentication Service.<a href="#section-6.5.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.5.2-2.2">
              <p id="section-6.5.2-2.2.1">The <code>credential_key</code> corresponds to the specified <code>credential</code>, in the same
way that the <code>signature_key</code> would have to correspond to the credential if
the credential were presented in a LeafNode.<a href="#section-6.5.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.5.2-2.3">
              <p id="section-6.5.2-2.3.1">The <code>signature</code> field is valid with respect to the <code>signature_key</code> value in
the leaf node.<a href="#section-6.5.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.5.2-3">A client that receives a credential of type <code>multi</code> in a LeafNode <span class="bcp14">MUST</span> verify
that all the following are true:<a href="#section-6.5.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5.2-4.1">
              <p id="section-6.5.2-4.1.1">All members of the group support credential type <code>multi</code>.<a href="#section-6.5.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.5.2-4.2">
              <p id="section-6.5.2-4.2.1">For each credential binding in the multi-credential:<a href="#section-6.5.2-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5.2-4.2.2.1">
                  <p id="section-6.5.2-4.2.2.1.1">Every member of the group supports the cipher suite and credential type
values for the binding.<a href="#section-6.5.2-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.5.2-4.2.2.2">
                  <p id="section-6.5.2-4.2.2.2.1">The binding is valid in the context of the LeafNode.<a href="#section-6.5.2-4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-6.5.2-5">A client that receives a credential of type <code>weak-multi</code> in a LeafNode <span class="bcp14">MUST</span>
verify that all the following are true:<a href="#section-6.5.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5.2-6.1">
              <p id="section-6.5.2-6.1.1">All members of the group support credential type <code>weak-multi</code>.<a href="#section-6.5.2-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.5.2-6.2">
              <p id="section-6.5.2-6.2.1">Each member of the group supports at least one binding in the
multi-credential. (Different members may support different subsets.)<a href="#section-6.5.2-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.5.2-6.3">
              <p id="section-6.5.2-6.3.1">Every binding that this client supports is valid in the context of the
LeafNode.<a href="#section-6.5.2-6.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document requests the addition of various new values under the heading of
"Messaging Layer Security". Each registration is organized under the relevant
registry Type.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">This document also requests the creation of a new MLS applications components
registry as described in <a href="#iana-components" class="auto internal xref">Section 7.5</a>.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">RFC EDITOR: Please replace XXXX throughout with the RFC number assigned to this
document<a href="#section-7-3" class="pilcrow">¶</a></p>
<div id="mls-wire-formats">
<section id="section-7.1">
        <h3 id="name-mls-wire-formats">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-mls-wire-formats" class="section-name selfRef">MLS Wire Formats</a>
      </h3>
</section>
</div>
<div id="mls-extension-types">
<section id="section-7.2">
        <h3 id="name-mls-extension-types">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-mls-extension-types" class="section-name selfRef">MLS Extension Types</a>
        </h3>
<div id="appdatadictionary-mls-extension">
<section id="section-7.2.1">
          <h4 id="name-app_data_dictionary-mls-ext">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-app_data_dictionary-mls-ext" class="section-name selfRef">app_data_dictionary MLS Extension</a>
          </h4>
<p id="section-7.2.1-1">The <code>app_data_dictionary</code> MLS Extension Type is used inside KeyPackage,
LeafNode, GroupContext, or GroupInfo objects. It contains a sorted list of
application component data objects (at most one per component).<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.1-2.1">
              <p id="section-7.2.1-2.1.1">Value: 0x0006 (suggested)<a href="#section-7.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-2.2">
              <p id="section-7.2.1-2.2.1">Name: app_data_dictionary<a href="#section-7.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-2.3">
              <p id="section-7.2.1-2.3.1">Message(s): KP: This extension may appear in KeyPackage objects
            LN: This extension may appear in LeafNode objects
            GC: This extension may appear in GroupContext objects
            GI: This extension may appear in GroupInfo objects<a href="#section-7.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-2.4">
              <p id="section-7.2.1-2.4.1">Recommended: Y<a href="#section-7.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-2.5">
              <p id="section-7.2.1-2.5.1">Reference: RFC XXXX<a href="#section-7.2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="supportedwireformats-mls-extension">
<section id="section-7.2.2">
          <h4 id="name-supported_wire_formats-mls-">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-supported_wire_formats-mls-" class="section-name selfRef">supported_wire_formats MLS Extension</a>
          </h4>
<p id="section-7.2.2-1">The <code>supported_wire_formats</code> MLS Extension Type is used inside LeafNode objects.
It contains a list of non-default Wire Formats supported by the client node.<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.2-2.1">
              <p id="section-7.2.2-2.1.1">Value: 0x0007 (suggested)<a href="#section-7.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-2.2">
              <p id="section-7.2.2-2.2.1">Name: supported_wire_formats<a href="#section-7.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-2.3">
              <p id="section-7.2.2-2.3.1">Message(s): LN: This extension may appear in LeafNode objects<a href="#section-7.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-2.4">
              <p id="section-7.2.2-2.4.1">Recommended: Y<a href="#section-7.2.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-2.5">
              <p id="section-7.2.2-2.5.1">Reference: RFC XXXX<a href="#section-7.2.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="requiredwireformats-mls-extension">
<section id="section-7.2.3">
          <h4 id="name-required_wire_formats-mls-e">
<a href="#section-7.2.3" class="section-number selfRef">7.2.3. </a><a href="#name-required_wire_formats-mls-e" class="section-name selfRef">required_wire_formats MLS Extension</a>
          </h4>
<p id="section-7.2.3-1">The <code>required_wire_formats</code> MLS Extension Type is used inside GroupContext
objects. It contains a list of non-default Wire Formats that are mandatory for
all MLS members of the group to support.<a href="#section-7.2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.3-2.1">
              <p id="section-7.2.3-2.1.1">Value: 0x0008 (suggested)<a href="#section-7.2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.3-2.2">
              <p id="section-7.2.3-2.2.1">Name: required_wire_formats<a href="#section-7.2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.3-2.3">
              <p id="section-7.2.3-2.3.1">Message(s): GC: This extension may appear in GroupContext objects<a href="#section-7.2.3-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.3-2.4">
              <p id="section-7.2.3-2.4.1">Recommended: Y<a href="#section-7.2.3-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.3-2.5">
              <p id="section-7.2.3-2.5.1">Reference: RFC XXXX<a href="#section-7.2.3-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="mls-proposal-types">
<section id="section-7.3">
        <h3 id="name-mls-proposal-types">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-mls-proposal-types" class="section-name selfRef">MLS Proposal Types</a>
        </h3>
<div id="appdataupdate-proposal">
<section id="section-7.3.1">
          <h4 id="name-appdataupdate-proposal">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-appdataupdate-proposal" class="section-name selfRef">AppDataUpdate Proposal</a>
          </h4>
<p id="section-7.3.1-1">The <code>app_data_update</code> MLS Proposal Type is used to efficiently update
application component data stored in the <code>app_data_dictionary</code> GroupContext
extension.<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.1-2.1">
              <p id="section-7.3.1-2.1.1">Value: 0x0008 (suggested)<a href="#section-7.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.1-2.2">
              <p id="section-7.3.1-2.2.1">Name: app_data_update<a href="#section-7.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.1-2.3">
              <p id="section-7.3.1-2.3.1">Recommended: Y<a href="#section-7.3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.1-2.4">
              <p id="section-7.3.1-2.4.1">External: Y<a href="#section-7.3.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.1-2.5">
              <p id="section-7.3.1-2.5.1">Path Required: N<a href="#section-7.3.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="appephemeral-proposal">
<section id="section-7.3.2">
          <h4 id="name-appephemeral-proposal">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-appephemeral-proposal" class="section-name selfRef">AppEphemeral Proposal</a>
          </h4>
<p id="section-7.3.2-1">The <code>app_ephemeral</code> MLS Proposal Type is used to send opaque ephemeral
 application data that needs to be synchronized with a specific MLS epoch.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.2-2.1">
              <p id="section-7.3.2-2.1.1">Value: 0x0009 (suggested)<a href="#section-7.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.2-2.2">
              <p id="section-7.3.2-2.2.1">Name: app_ephemeral<a href="#section-7.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.2-2.3">
              <p id="section-7.3.2-2.3.1">Recommended: Y<a href="#section-7.3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.2-2.4">
              <p id="section-7.3.2-2.4.1">External: Y<a href="#section-7.3.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.2-2.5">
              <p id="section-7.3.2-2.5.1">Path Required: N<a href="#section-7.3.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="selfremove-proposal-1">
<section id="section-7.3.3">
          <h4 id="name-selfremove-proposal-2">
<a href="#section-7.3.3" class="section-number selfRef">7.3.3. </a><a href="#name-selfremove-proposal-2" class="section-name selfRef">SelfRemove Proposal</a>
          </h4>
<p id="section-7.3.3-1">The <code>self_remove</code> MLS Proposal Type is used for a member to remove itself from a
group more efficiently than using a <code>remove</code> proposal type, as the <code>self_remove</code>
type is permitted in External Commits.<a href="#section-7.3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.3-2.1">
              <p id="section-7.3.3-2.1.1">Value: 0x000a (suggested)<a href="#section-7.3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.3-2.2">
              <p id="section-7.3.3-2.2.1">Name: self_remove<a href="#section-7.3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.3-2.3">
              <p id="section-7.3.3-2.3.1">Recommended: Y<a href="#section-7.3.3-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.3-2.4">
              <p id="section-7.3.3-2.4.1">External: N<a href="#section-7.3.3-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.3-2.5">
              <p id="section-7.3.3-2.5.1">Path Required: Y<a href="#section-7.3.3-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="appack-proposal">
<section id="section-7.3.4">
          <h4 id="name-appack-proposal">
<a href="#section-7.3.4" class="section-number selfRef">7.3.4. </a><a href="#name-appack-proposal" class="section-name selfRef">AppAck Proposal</a>
          </h4>
<p id="section-7.3.4-1">The <code>app_ack</code> MLS Proposal Type can be used by group members to acknowledge the
receipt of application messages.<a href="#section-7.3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.4-2.1">
              <p id="section-7.3.4-2.1.1">Value: 0x000b (suggested)<a href="#section-7.3.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.4-2.2">
              <p id="section-7.3.4-2.2.1">Name: app_ack<a href="#section-7.3.4-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.4-2.3">
              <p id="section-7.3.4-2.3.1">Recommended: Y<a href="#section-7.3.4-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.4-2.4">
              <p id="section-7.3.4-2.4.1">External: N<a href="#section-7.3.4-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.4-2.5">
              <p id="section-7.3.4-2.5.1">Path Required: N<a href="#section-7.3.4-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="iana-creds">
<section id="section-7.4">
        <h3 id="name-mls-credential-types">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-mls-credential-types" class="section-name selfRef">MLS Credential Types</a>
        </h3>
<div id="multi-credential">
<section id="section-7.4.1">
          <h4 id="name-multi-credential">
<a href="#section-7.4.1" class="section-number selfRef">7.4.1. </a><a href="#name-multi-credential" class="section-name selfRef">Multi Credential</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-7.4.1-1.1">
              <p id="section-7.4.1-1.1.1">Value: 0x0003 (suggested)<a href="#section-7.4.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.4.1-1.2">
              <p id="section-7.4.1-1.2.1">Name: multi<a href="#section-7.4.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.4.1-1.3">
              <p id="section-7.4.1-1.3.1">Recommended: Y<a href="#section-7.4.1-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.4.1-1.4">
              <p id="section-7.4.1-1.4.1">Reference: RFC XXXX<a href="#section-7.4.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="weak-multi-credential">
<section id="section-7.4.2">
          <h4 id="name-weak-multi-credential">
<a href="#section-7.4.2" class="section-number selfRef">7.4.2. </a><a href="#name-weak-multi-credential" class="section-name selfRef">Weak Multi Credential</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-7.4.2-1.1">
              <p id="section-7.4.2-1.1.1">Value: 0x0004<a href="#section-7.4.2-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.4.2-1.2">
              <p id="section-7.4.2-1.2.1">Name: weak-multi<a href="#section-7.4.2-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.4.2-1.3">
              <p id="section-7.4.2-1.3.1">Recommended: Y<a href="#section-7.4.2-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.4.2-1.4">
              <p id="section-7.4.2-1.4.1">Reference: RFC XXXX<a href="#section-7.4.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="credentialbindingtbs">
<section id="section-7.4.3">
          <h4 id="name-credentialbindingtbs">
<a href="#section-7.4.3" class="section-number selfRef">7.4.3. </a><a href="#name-credentialbindingtbs" class="section-name selfRef">CredentialBindingTBS</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-7.4.3-1.1">
              <p id="section-7.4.3-1.1.1">Label: "CredentialBindingTBS"<a href="#section-7.4.3-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.4.3-1.2">
              <p id="section-7.4.3-1.2.1">Recommended: Y<a href="#section-7.4.3-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.4.3-1.3">
              <p id="section-7.4.3-1.3.1">Reference: RFC XXXX<a href="#section-7.4.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="iana-components">
<section id="section-7.5">
        <h3 id="name-mls-component-types">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-mls-component-types" class="section-name selfRef">MLS Component Types</a>
        </h3>
<p id="section-7.5-1">This document requests the creation of a new IANA "MLS Component Types" registry
under the "Messaging Layer Security" group registry heading. Assignments to this
registry in the range 0x0000 to 0x7FFF are via Specification Required
policy <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span> using the MLS Designated Experts. Assignments in the range
0x8000 to 0xFFFF are for private use.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">Template:<a href="#section-7.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.5-3.1">
            <p id="section-7.5-3.1.1">Value: The numeric value of the component ID<a href="#section-7.5-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.5-3.2">
            <p id="section-7.5-3.2.1">Name: The name of the component<a href="#section-7.5-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.5-3.3">
            <p id="section-7.5-3.3.1">Where: The objects(s) in which the component may appear,
       drawn from the following list:<a href="#section-7.5-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.5-3.3.2.1">
                <p id="section-7.5-3.3.2.1.1">AD: SafeAAD objects<a href="#section-7.5-3.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.5-3.3.2.2">
                <p id="section-7.5-3.3.2.2.1">AE: AppEpheral proposals<a href="#section-7.5-3.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.5-3.3.2.3">
                <p id="section-7.5-3.3.2.3.1">ES: Exporter Secret labels<a href="#section-7.5-3.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.5-3.3.2.4">
                <p id="section-7.5-3.3.2.4.1">GC: GroupContext objects<a href="#section-7.5-3.3.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.5-3.3.2.5">
                <p id="section-7.5-3.3.2.5.1">GI: GroupInfo objects<a href="#section-7.5-3.3.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.5-3.3.2.6">
                <p id="section-7.5-3.3.2.6.1">HP: HPKE key labels<a href="#section-7.5-3.3.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.5-3.3.2.7">
                <p id="section-7.5-3.3.2.7.1">KP: KeyPackage objects<a href="#section-7.5-3.3.2.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.5-3.3.2.8">
                <p id="section-7.5-3.3.2.8.1">LN: LeafNode objects<a href="#section-7.5-3.3.2.8.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.5-3.3.2.9">
                <p id="section-7.5-3.3.2.9.1">PS: PSK labels<a href="#section-7.5-3.3.2.9.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.5-3.3.2.10">
                <p id="section-7.5-3.3.2.10.1">SK: Signature Key labels<a href="#section-7.5-3.3.2.10.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.5-3.4">
            <p id="section-7.5-3.4.1">Recommended: Same as in <span><a href="https://rfc-editor.org/rfc/rfc9420#section-17.1" class="relref">Section 17.1</a> of [<a href="#RFC9420" class="cite xref">RFC9420</a>]</span><a href="#section-7.5-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.5-3.5">
            <p id="section-7.5-3.5.1">Reference: The document where this component is defined<a href="#section-7.5-3.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.5-4">The restrictions noted in the "Where" column are to be enforced by the
application. MLS implementations <span class="bcp14">MUST NOT</span> impose restrictions on where component
IDs are used in which parts of MLS, unless specifically directed to by the
application.<a href="#section-7.5-4" class="pilcrow">¶</a></p>
<p id="section-7.5-5">Initial Contents:<a href="#section-7.5-5" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Where</th>
              <th class="text-left" rowspan="1" colspan="1">R</th>
              <th class="text-left" rowspan="1" colspan="1">Ref</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0000</td>
              <td class="text-left" rowspan="1" colspan="1">RESERVED</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0001</td>
              <td class="text-left" rowspan="1" colspan="1">app_components</td>
              <td class="text-left" rowspan="1" colspan="1">LN,GC</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0002</td>
              <td class="text-left" rowspan="1" colspan="1">safe_aad</td>
              <td class="text-left" rowspan="1" colspan="1">LN,GC</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0003</td>
              <td class="text-left" rowspan="1" colspan="1">content_media_types</td>
              <td class="text-left" rowspan="1" colspan="1">LN,GC</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0004</td>
              <td class="text-left" rowspan="1" colspan="1">last_resort_key_package</td>
              <td class="text-left" rowspan="1" colspan="1">KP</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0005</td>
              <td class="text-left" rowspan="1" colspan="1">app_ack</td>
              <td class="text-left" rowspan="1" colspan="1">AE</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0A0A</td>
              <td class="text-left" rowspan="1" colspan="1">GREASE</td>
              <td class="text-left" rowspan="1" colspan="1">Note1</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x1A1A</td>
              <td class="text-left" rowspan="1" colspan="1">GREASE</td>
              <td class="text-left" rowspan="1" colspan="1">Note1</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x2A2A</td>
              <td class="text-left" rowspan="1" colspan="1">GREASE</td>
              <td class="text-left" rowspan="1" colspan="1">Note1</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x3A3A</td>
              <td class="text-left" rowspan="1" colspan="1">GREASE</td>
              <td class="text-left" rowspan="1" colspan="1">Note1</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x4A4A</td>
              <td class="text-left" rowspan="1" colspan="1">GREASE</td>
              <td class="text-left" rowspan="1" colspan="1">Note1</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x5A5A</td>
              <td class="text-left" rowspan="1" colspan="1">GREASE</td>
              <td class="text-left" rowspan="1" colspan="1">Note1</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x6A6A</td>
              <td class="text-left" rowspan="1" colspan="1">GREASE</td>
              <td class="text-left" rowspan="1" colspan="1">Note1</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x7A7A</td>
              <td class="text-left" rowspan="1" colspan="1">GREASE</td>
              <td class="text-left" rowspan="1" colspan="1">Note1</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x8000 -</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0xFFFF</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved for Private Use</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
              <td class="text-left" rowspan="1" colspan="1">RFCXXXX</td>
            </tr>
          </tbody>
        </table>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.5-7.1">
            <p id="section-7.5-7.1.1">Note1: GREASE values for components <span class="bcp14">MAY</span> be present in AD, AE, GI, KP, and LN
objects.<a href="#section-7.5-7.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security considerations</a>
      </h2>
<div id="safe-application-api">
<section id="section-8.1">
        <h3 id="name-safe-application-api">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-safe-application-api" class="section-name selfRef">Safe Application API</a>
        </h3>
<p id="section-8.1-1">The Safe Application API provides the following security guarantee: If an
application uses MLS with application components, the security guarantees of the
base MLS protocol and the security guarantees of each application component
analyzed in isolation, still hold for the composed application of the MLS
protocol. In other words, the Safe Application API protects applications from
careless component developers. It is not possible that a combination of
components (the developers of which did not know about each other) impedes the
security of the base MLS protocol or any other component. No further analysis of
the combination is necessary. This also means that any security vulnerabilities
introduced by one component do not spread to other components or the base MLS
implementation.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="appack-1">
<section id="section-8.2">
        <h3 id="name-appack-2">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-appack-2" class="section-name selfRef">AppAck</a>
        </h3>
<p id="section-8.2-1">When AppAck objects are received, they allow clients to detect if the Delivery
Service (or an intermediary) dropped application messages, since gaps in the
<code>generation</code> sequence indicate dropped messages. When AppAck messages are
accepted by the Delivery Service, but not received by some members, the members
who have missed the corresponding AppEphemeral proposals will not be able to
send or receive a commit message, because the proposal is included in the
transcript hash. Likewise, if AppAck objects and/or commits are sent
periodically by every member, other members will be able to detect a member that
is no longer sending on that schedule or whose handshake messages are being
suppressed by the DS.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.2-2.1">
            <p id="section-8.2-2.1.1">Note: External Commits do not typically contain pending proposals (including
AppEphemeral proposals). Client that send an AppAck component in an
AppEphemeral proposal will need to send a new AppAck component in an
AppEphemeral proposal (in the new epoch) after receiving an External Commit
until it has been incorporated into an accepted Commit.<a href="#section-8.2-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.2-3">The schedule on which AppAck objects are sent in AppEphemeral proposals is up to
the application, and determines which cases of loss/suppression are detected.
For example:<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-4.1">
            <p id="section-8.2-4.1.1">The application might have the committer include an AppAck whenever a Commit
is sent, so that other members could know when one of their messages did not
reach the committer.<a href="#section-8.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-4.2">
            <p id="section-8.2-4.2.1">The application could have a client send an AppAck whenever an application
message is sent, covering all messages received since its last AppAck. This
would provide a complete view of any losses experienced by active members.<a href="#section-8.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-4.3">
            <p id="section-8.2-4.3.1">The application could simply have clients send AppAck proposals on a timer, so
that all participants' state would be known.<a href="#section-8.2-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.2-5">An application using AppAck to guard against loss/suppression of application
messages also needs to ensure that AppAck messages and the Commits that
reference them are not dropped. One way to do this is to always encrypt Proposal
and Commit messages, to make it more difficult for the Delivery Service to
recognize which messages contain AppAcks. The application can also have clients
enforce an AppAck schedule, reporting loss if an AppAck is not received at the
expected time.<a href="#section-8.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="content-advertisement-1">
<section id="section-8.3">
        <h3 id="name-content-advertisement-2">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-content-advertisement-2" class="section-name selfRef">Content Advertisement</a>
        </h3>
<p id="section-8.3-1">Use of the <code>content_media_types</code> component could leak some private information
visible in KeyPackages and inside an MLS group. This could be used to infer a
specific implementation, platform, or even version. Clients should carefully
consider the privacy implications in their environment of making a list of
acceptable media types available.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">Implementations need to be prepared to parse media types containing long
parameter lists, potentially containing characters which would be escaped or
quoted in <span>[<a href="#RFC5322" class="cite xref">RFC5322</a>]</span>.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="selfremove">
<section id="section-8.4">
        <h3 id="name-selfremove">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-selfremove" class="section-name selfRef">SelfRemove</a>
        </h3>
<p id="section-8.4-1">An external recipient of a SelfRemove Proposal cannot verify the
<code>membership_tag</code>. However, an external joiner also has no way to completely
validate a GroupInfo object that it receives. An insider can prevent an External
Join by providing either an invalid GroupInfo object or an invalid SelfRemove
Proposal. The security properties of external joins does not change with the
addition of this proposal type.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multi-credentials-1">
<section id="section-8.5">
        <h3 id="name-multi-credentials-2">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-multi-credentials-2" class="section-name selfRef">Multi Credentials</a>
        </h3>
<p id="section-8.5-1">Using a Weak Multi Credential reduces the overall credential security to the
security of the least secure of its credential bindings.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5322">[RFC5322]</dt>
        <dd>
<span class="refAuthor">Resnick, P., Ed.</span>, <span class="refTitle">"Internet Message Format"</span>, <span class="seriesInfo">RFC 5322</span>, <span class="seriesInfo">DOI 10.17487/RFC5322</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5322">https://www.rfc-editor.org/rfc/rfc5322</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9180">[RFC9180]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Lipp, B.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Hybrid Public Key Encryption"</span>, <span class="seriesInfo">RFC 9180</span>, <span class="seriesInfo">DOI 10.17487/RFC9180</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9180">https://www.rfc-editor.org/rfc/rfc9180</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9420">[RFC9420]</dt>
      <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Beurdouche, B.</span>, <span class="refAuthor">Robert, R.</span>, <span class="refAuthor">Millican, J.</span>, <span class="refAuthor">Omara, E.</span>, and <span class="refAuthor">K. Cohn-Gordon</span>, <span class="refTitle">"The Messaging Layer Security (MLS) Protocol"</span>, <span class="seriesInfo">RFC 9420</span>, <span class="seriesInfo">DOI 10.17487/RFC9420</span>, <time datetime="2023-07" class="refDate">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9420">https://www.rfc-editor.org/rfc/rfc9420</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-mls-architecture">[I-D.ietf-mls-architecture]</dt>
        <dd>
<span class="refAuthor">Beurdouche, B.</span>, <span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Omara, E.</span>, <span class="refAuthor">Inguva, S.</span>, and <span class="refAuthor">A. Duric</span>, <span class="refTitle">"The Messaging Layer Security (MLS) Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-mls-architecture-15</span>, <time datetime="2024-08-03" class="refDate">3 August 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-mls-architecture-15">https://datatracker.ietf.org/doc/html/draft-ietf-mls-architecture-15</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2045">[RFC2045]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"</span>, <span class="seriesInfo">RFC 2045</span>, <span class="seriesInfo">DOI 10.17487/RFC2045</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2045">https://www.rfc-editor.org/rfc/rfc2045</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2046">[RFC2046]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types"</span>, <span class="seriesInfo">RFC 2046</span>, <span class="seriesInfo">DOI 10.17487/RFC2046</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2046">https://www.rfc-editor.org/rfc/rfc2046</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
      <dd>
<span class="refAuthor">Freed, N.</span>, <span class="refAuthor">Klensin, J.</span>, and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6838">https://www.rfc-editor.org/rfc/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="change-log">
<section id="appendix-A">
      <h2 id="name-change-log">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-change-log" class="section-name selfRef">Change Log</a>
      </h2>
<p id="appendix-A-1">RFC EDITOR PLEASE DELETE THIS SECTION.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">draft-07
- add AppAck to IANA considerations
- adapt Safe AAD scope
- remove targeted messages altogether with intention to publish it as a
  separate document
- assign self_remove proposal to a non duplicate number (0x000a)
- refactor TargetedMessage to no longer use structs removed from when it
was a "safe extension"
- remove the no-longer needed targeted_messages_capability (now signaled using
  support_wire_formats and required_wire_formats)
- add TargetedMessageTBS and CredentialBundleTBS to MLS Signature Labels IANA
  registry
- add GREASE values for components
- fix safe exporter definition
- resolve TODOs from -06
- fix numerous typos<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">draft-06<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-4.1">
          <p id="appendix-A-4.1.1">Integrate notion of Application API from draft-barnes-mls-appsync<a href="#appendix-A-4.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-5">draft-05<a href="#appendix-A-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-6.1">
          <p id="appendix-A-6.1.1">Include definition of ExtensionState extension<a href="#appendix-A-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-6.2">
          <p id="appendix-A-6.2.1">Add safe use of AAD to Safe Extensions framework<a href="#appendix-A-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-6.3">
          <p id="appendix-A-6.3.1">Clarify how capabilities negotiation works in Safe Extensions framework<a href="#appendix-A-6.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-7">draft-04<a href="#appendix-A-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-8.1">
          <p id="appendix-A-8.1.1">No changes (prevent expiration)<a href="#appendix-A-8.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-9">draft-03<a href="#appendix-A-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-10.1">
          <p id="appendix-A-10.1.1">Add Last Resort KeyPackage extension<a href="#appendix-A-10.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-10.2">
          <p id="appendix-A-10.2.1">Add Safe Extensions framework<a href="#appendix-A-10.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-10.3">
          <p id="appendix-A-10.3.1">Add SelfRemove Proposal<a href="#appendix-A-10.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-11">draft-02<a href="#appendix-A-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-12.1">
          <p id="appendix-A-12.1.1">No changes (prevent expiration)<a href="#appendix-A-12.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-13">draft-01<a href="#appendix-A-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-14.1">
          <p id="appendix-A-14.1.1">Add Content Advertisement extensions<a href="#appendix-A-14.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-15">draft-00<a href="#appendix-A-15" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-16.1">
          <p id="appendix-A-16.1.1">Initial adoption of draft-robert-mls-protocol-00 as a WG item.<a href="#appendix-A-16.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-16.2">
          <p id="appendix-A-16.2.1">Add Targeted Messages extension (*)<a href="#appendix-A-16.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="contributors">
<section id="appendix-B">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Joel Alwen</span></div>
<div dir="auto" class="left"><span class="org">Amazon</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:alwenjo@amazon.com" class="email">alwenjo@amazon.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Konrad Kohbrok</span></div>
<div dir="auto" class="left"><span class="org">Phoenix R&amp;D</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:konrad.kohbrok@datashrine.de" class="email">konrad.kohbrok@datashrine.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rohan Mahy</span></div>
<div dir="auto" class="left"><span class="org">Rohan Mahy Consulting Services</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rohan.ietf@gmail.com" class="email">rohan.ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marta Mularczyk</span></div>
<div dir="auto" class="left"><span class="org">Amazon</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mulmarta@amazon.com" class="email">mulmarta@amazon.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Richard Barnes</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rlb@ipv.sx" class="email">rlb@ipv.sx</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Raphael Robert</span></div>
<div dir="auto" class="left"><span class="org">Phoenix R&amp;D</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@raphaelrobert.com" class="email">ietf@raphaelrobert.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
